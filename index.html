<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>PreMed Learning Science Lab | UW-Parkside</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    /* ------------------------------------------------
       UW-Parkside Brand Palette (Web Hex)
       Primary: Green #016836, Black #21272
       Secondary: Dark Green #00502f, Cool Grey #DBD9D6,
                  Goldenrod #FABA31, White Birch #EFECE2
       Accent (sparingly): Prairie Fire #FF4500
       ------------------------------------------------ [attached_file:1]
    */
    :root {
      --uwp-green: #016836;
      --uwp-black: #21272;
      --uwp-dark-green: #00502f;
      --uwp-cool-grey: #dbd9d6;
      --uwp-goldenrod: #faba31;
      --uwp-white-birch: #efece2;
      --uwp-accent-prairie-fire: #ff4500;

      --bg: #f8fafc;
      --ink: #111827;
      --muted: #4b5563;

      --card-bg: #ffffff;
      --card-border: #e5e7eb;

      --btn-primary-bg: var(--uwp-green);
      --btn-primary-text: #ffffff;
      --btn-secondary-bg: #ffffff;
      --btn-secondary-text: var(--uwp-green);

      --progress-track: var(--uwp-cool-grey);
      --progress-bar: var(--uwp-green);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: linear-gradient(180deg, var(--uwp-white-birch), #ffffff);
      color: var(--ink);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header, footer {
      padding: 0.75rem 1rem;
      color: #ffffff;
    }

    header {
      background: linear-gradient(90deg, var(--uwp-dark-green), var(--uwp-green));
      border-bottom: 4px solid var(--uwp-goldenrod);
    }

    footer {
      background: var(--uwp-black);
      border-top: 4px solid var(--uwp-green);
      margin-top: auto;
      font-size: 0.85rem;
    }

    .shell {
      max-width: 960px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
    }

    main {
      flex: 1;
      padding: 1rem;
      display: flex;
      justify-content: center;
    }

    .view {
      display: none;
      max-width: 960px;
      width: 100%;
      margin: 0 auto;
    }
    .view.active {
      display: block;
    }

    h1, h2, h3 {
      font-weight: 600;
      letter-spacing: 0.02em;
    }
    h1 { font-size: 1.4rem; margin: 0; }
    h2 { font-size: 1.35rem; margin-top: 0; color: var(--uwp-black); }
    h3 { font-size: 1.1rem; margin-top: 0.5rem; color: var(--uwp-dark-green); }
    p { line-height: 1.5; }

    .subline {
      font-size: 0.85rem;
      opacity: 0.9;
    }

    /* Progress */
    .progress-shell {
      flex: 1;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      max-width: 340px;
      margin-left: 0.5rem;
    }
    .progress-track {
      flex: 1;
      height: 8px;
      border-radius: 999px;
      background: var(--progress-track);
      overflow: hidden;
    }
    .progress-bar {
      height: 100%;
      width: 0%;
      border-radius: 999px;
      background: var(--progress-bar);
      transition: width 0.3s ease;
    }
    .progress-label {
      font-size: 0.8rem;
      white-space: nowrap;
    }

    /* Buttons */
    .btn {
      border-radius: 999px;
      padding: 0.45rem 1rem;
      font-size: 0.9rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      border: 1px solid transparent;
      font-weight: 500;
      transition: background 0.1s ease, color 0.1s ease, border-color 0.1s ease, transform 0.08s ease;
    }
    .btn-primary {
      background: var(--btn-primary-bg);
      color: var(--btn-primary-text);
      border-color: rgba(0,0,0,0.1);
    }
    .btn-primary:hover {
      background: var(--uwp-dark-green);
      transform: translateY(-1px);
    }
    .btn-secondary {
      background: var(--btn-secondary-bg);
      color: var(--btn-secondary-text);
      border-color: var(--uwp-green);
    }
    .btn-secondary:hover {
      background: var(--uwp-green);
      color: #ffffff;
      transform: translateY(-1px);
    }
    .btn-danger {
      background: #ffffff;
      color: var(--uwp-black);
      border-color: var(--uwp-accent-prairie-fire);
    }
    .btn-danger:hover {
      background: var(--uwp-accent-prairie-fire);
      color: #ffffff;
      transform: translateY(-1px);
    }
    .btn:disabled {
      opacity: 0.4;
      cursor: default;
      transform: none;
    }

    /* Cards & layout */
    .card {
      background: var(--card-bg);
      border-radius: 0.75rem;
      border: 1px solid var(--card-border);
      padding: 1.25rem 1.35rem;
      box-shadow: 0 10px 24px rgba(33, 39, 42, 0.08);
    }
    .card + .card { margin-top: 1rem; }

    .stack {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit,minmax(230px,1fr));
      gap: 1rem;
      margin-top: 1rem;
    }

    .meta {
      font-size: 0.85rem;
      color: var(--muted);
    }

    .chip {
      display: inline-flex;
      align-items: center;
      padding: 0.15rem 0.6rem;
      border-radius: 999px;
      font-size: 0.75rem;
      border: 1px solid var(--uwp-green);
      color: var(--uwp-green);
      background: #ffffff;
    }
    .chip.completed {
      background: var(--uwp-green);
      color: #ffffff;
    }

    textarea, input, select {
      width: 100%;
      border-radius: 0.6rem;
      border: 1px solid #cbd5f5;
      padding: 0.6rem 0.7rem;
      background: #ffffff;
      color: var(--ink);
      font-size: 0.9rem;
      resize: vertical;
      font-family: inherit;
    }
    textarea { min-height: 140px; }

    label {
      display: block;
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--muted);
      margin-bottom: 0.25rem;
    }
    .field { margin-bottom: 1rem; }

    .pill-nav {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
      margin-bottom: 1rem;
    }

    .observation-box {
      background: var(--uwp-white-birch);
      border-radius: 0.65rem;
      border: 1px solid #e5e7eb;
      padding: 0.85rem 1rem;
      font-style: italic;
      color: #111827;
    }

    .banner {
      border-left: 4px solid var(--uwp-green);
      padding-left: 0.75rem;
    }

    .hidden { display: none !important; }

    @media (max-width: 640px) {
      .shell {
        flex-direction: column;
        align-items: flex-start;
      }
      .progress-shell {
        margin-left: 0;
        max-width: 100%;
      }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="shell">
      <div style="display:flex;align-items:center;gap:0.75rem;">
        <div style="width:34px;height:34px;border-radius:50%;border:2px solid var(--uwp-goldenrod);display:flex;align-items:center;justify-content:center;font-size:0.9rem;background:#ffffff10;">
          UWP
        </div>
        <div>
          <h1>PreMed Learning Science Lab</h1>
          <div class="subline">University of Wisconsin–Parkside | Evidence-based study experiments.</div>
        </div>
      </div>
      <div class="progress-shell" aria-label="Overall progress">
        <div class="progress-track" aria-hidden="true">
          <div class="progress-bar" id="globalProgressBar"></div>
        </div>
        <div class="progress-label" id="globalProgressLabel">0% complete</div>
      </div>
      <div style="display:flex;gap:0.5rem;">
        <button class="btn btn-secondary" id="exportBtn" type="button">Export</button>
        <button class="btn btn-danger" id="resetBtn" type="button">Reset</button>
      </div>
    </div>
  </header>

  <!-- Main -->
  <main>
    <!-- Landing View -->
    <div class="view active" id="view-landing" aria-labelledby="landingTitle">
      <div class="card stack">
        <div class="banner">
          <h2 id="landingTitle">When hard work does not match your exam scores</h2>
          <p>
            You put in the hours—highlighting, rereading, rewriting. The pages look neat, the effort feels
            real, and it seems like the right thing to do. But when the exam asks you to recall concepts
            from scratch, the results do not match the time you invested. [file:12]
          </p>
          <p>
            This lab, designed for PreMed students at UW–Parkside, turns you into a scientist of your own
            learning. In ten short experiments, you will contrast your study habits with cognitive science
            research, make predictions, and run small trials in your real courses. [file:12][attached_file:1]
          </p>
        </div>
        <div style="display:flex;gap:0.75rem;flex-wrap:wrap;align-items:center;">
          <button class="btn btn-primary" type="button" data-nav="dashboard">
            Begin your study transformation
          </button>
          <button class="btn btn-secondary" type="button" data-nav="roadmap">
            Peek at the roadmap
          </button>
        </div>
      </div>
    </div>

    <!-- Dashboard View -->
    <div class="view" id="view-dashboard" aria-labelledby="dashboardTitle">
      <div class="card stack">
        <div>
          <h2 id="dashboardTitle">Your experiment deck</h2>
          <p class="meta">
            Complete experiments in any order. Each takes about 10–15 minutes and ends with a concrete
            change you can test in a real UWP course. [file:12][attached_file:1]
          </p>
        </div>
        <div class="dashboard-grid">
          <!-- Active Recall Arena -->
          <article class="card" data-experiment-card="activerecallarena">
            <h3>Active Recall Arena</h3>
            <p class="meta">
              Retrieval vs rereading: why recognizing material in your notes is not the same as being able
              to produce it on an exam. [file:12]
            </p>
            <div style="display:flex;justify-content:space-between;align-items:center;margin-top:0.75rem;">
              <span class="chip" id="chip-activerecallarena">Not started</span>
              <button class="btn btn-secondary" type="button" data-open-experiment="activerecallarena">
                Open
              </button>
            </div>
          </article>

          <!-- Placeholder cards for future experiments -->
          <article class="card">
            <h3>Spacing vs Cramming</h3>
            <p class="meta">Placeholder for a future experiment on distributed vs massed practice.</p>
          </article>
          <article class="card">
            <h3>Interleaving Gauntlet</h3>
            <p class="meta">Placeholder for a future experiment on mixed vs blocked practice sets.</p>
          </article>
        </div>
      </div>
    </div>

    <!-- Experiment View (Active Recall Arena) -->
    <div class="view" id="view-experiment" aria-labelledby="experimentTitle">
      <div class="pill-nav">
        <button class="btn btn-secondary" type="button" data-nav="dashboard">
          &larr; Back to dashboard
        </button>
      </div>
      <div class="card stack">
        <header>
          <h2 id="experimentTitle">Active Recall Arena</h2>
          <p class="meta">
            Retrieval practice vs rereading. In this experiment, you will compare your instincts about
            studying to data from controlled experiments. [file:12]
          </p>
        </header>

        <!-- Phase 1 -->
        <section aria-labelledby="phase1Title">
          <h3 id="phase1Title">Phase 1 — Recognition vs recall</h3>
          <div class="observation-box">
            “My go-to study method is to read my notes and the textbook over and over. It feels
            comfortable, and I start to recognize the material. But when the exam asks me to write answers
            from scratch, I freeze. My Cs tell me recognition is not enough.” [file:12]
          </div>
          <div class="field">
            <label for="reflectionText">Pause for personal reflection</label>
            <p class="meta">
              Think about your last major exam. How did you prepare? How did it feel in the moment? What
              actually happened on the test? Try to write at least 100 words. [file:12]
            </p>
            <textarea id="reflectionText" placeholder="Type your honest reflection here..."></textarea>
            <div class="meta" id="reflectionMeta">0 / 100 words</div>
          </div>
          <button class="btn btn-primary" type="button" id="reflectionContinueBtn" disabled>
            I have reflected — continue
          </button>
        </section>

        <!-- Phase 2–3 -->
        <section id="phase2plus" class="hidden" aria-labelledby="phase2Title">
          <h3 id="phase2Title">Phase 2 — Curiosity and research question</h3>
          <p>
            Curiosity question: <strong>What would happen if I tested myself on the material instead of
            just rereading it?</strong> [file:12]
          </p>
          <p>
            Research question: <strong>Does retrieval practice self‑testing produce better long‑term
            retention than repeated rereading when studying course material?</strong> [file:12]
          </p>

          <h3>Phase 3 — Your prediction</h3>
          <p>
            Hypothesis: Retrieval practice (independent variable) leads to higher delayed test performance
            (dependent variable) than repeated rereading when study time and materials are held constant
            (control variables). [file:12]
          </p>
          <div class="field">
            <label for="predictionChoice">Which strategy do you predict will win on a delayed test?</label>
            <select id="predictionChoice">
              <option value="">Select your prediction…</option>
              <option value="rereading">Repeated rereading will do better</option>
              <option value="retrieval">Retrieval practice will do better</option>
              <option value="same">They will be about the same</option>
            </select>
          </div>
          <div class="field">
            <label for="predictionConfidence">How confident are you in this prediction? (1–5)</label>
            <input id="predictionConfidence" type="number" min="1" max="5" />
          </div>
          <button class="btn btn-primary" type="button" id="predictionContinueBtn" disabled>
            Lock in my prediction
          </button>
        </section>

        <!-- Placeholder for later phases -->
        <section id="phasePlaceholder" class="hidden">
          <h3>Next phases coming soon</h3>
          <p class="meta">
            This skeleton focuses on navigation, Phase 1–3, and state persistence. Additional phases
            (experimental design, results, personal experiment planner, article link, completion) can
            attach to the same pattern. [file:12]
          </p>
        </section>
      </div>
    </div>

    <!-- Roadmap View -->
    <div class="view" id="view-roadmap" aria-labelledby="roadmapTitle">
      <div class="card stack">
        <h2 id="roadmapTitle">Your future study roadmap</h2>
        <p>
          After you complete all ten experiments, this space will help you design a weekly schedule built
          around your peak time of day, evidence-based 50‑minute sessions, and a 1‑3‑7‑14‑30 spacing
          rhythm. [file:12]
        </p>
        <p class="meta">
          For now, this is a placeholder so you can wire up navigation and localStorage. The final version
          will read from your experiment data to generate UWP‑specific recommendations and handouts you can
          share in Canvas. [file:12][attached_file:1]
        </p>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer>
    <div class="shell" style="flex-direction:column;align-items:flex-start;">
      <div>
        Your inputs are stored only in your browser via localStorage. No accounts, no tracking, and no data
        is sent to a server. [file:12]
      </div>
      <div style="margin-top:0.35rem;font-size:0.8rem;">
        Designed for UW–Parkside students using official Parkside colors to support a consistent learning
        experience. [attached_file:1]
      </div>
    </div>
  </footer>

  <script>
    // ---------- STATE & LOCALSTORAGE ----------
    const STORAGE_KEY = "premedStudyLab";

    const defaultState = {
      experiments: {
        activerecallarena: {
          id: "activerecallarena",
          completed: false,
          personalReflection: "",
          reflectionWordCount: 0,
          predictionChoice: "",
          predictionConfidence: "",
          completedDate: null
        }
      },
      roadmap: {
        peakTime: "",
        scheduleTemplate: "",
        lastGenerated: null
      },
      lastViewedExperimentId: null,
      progressPercentage: 0
    };

    function loadState() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) return structuredClone(defaultState);
        const parsed = JSON.parse(raw);
        return { ...structuredClone(defaultState), ...parsed };
      } catch (e) {
        console.warn("Failed to parse stored state; resetting.", e);
        return structuredClone(defaultState);
      }
    }

    function saveState() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
      updateGlobalProgressUI();
      updateExperimentChips();
    }

    let state = loadState();

    // ---------- VIEW NAV ----------
    const views = {
      landing: document.getElementById("view-landing"),
      dashboard: document.getElementById("view-dashboard"),
      experiment: document.getElementById("view-experiment"),
      roadmap: document.getElementById("view-roadmap")
    };

    function showView(name) {
      Object.entries(views).forEach(([key, el]) => {
        el.classList.toggle("active", key === name);
      });
      if (name === "experiment" && state.lastViewedExperimentId === "activerecallarena") {
        hydrateExperimentUI();
      }
    }

    document.querySelectorAll("[data-nav]").forEach(btn => {
      btn.addEventListener("click", () => {
        const target = btn.getAttribute("data-nav");
        showView(target);
      });
    });

    document.querySelectorAll("[data-open-experiment]").forEach(btn => {
      btn.addEventListener("click", () => {
        const id = btn.getAttribute("data-open-experiment");
        state.lastViewedExperimentId = id;
        saveState();
        showView("experiment");
      });
    });

    // ---------- PROGRESS ----------
    const progressBar = document.getElementById("globalProgressBar");
    const progressLabel = document.getElementById("globalProgressLabel");

    function recomputeProgress() {
      const experiments = Object.values(state.experiments);
      if (!experiments.length) return 0;
      const completed = experiments.filter(e => e.completed).length;
      return Math.round((completed / experiments.length) * 100);
    }

    function updateGlobalProgressUI() {
      state.progressPercentage = recomputeProgress();
      const pct = state.progressPercentage || 0;
      progressBar.style.width = pct + "%";
      progressLabel.textContent = pct + "% complete";
    }

    function updateExperimentChips() {
      const exp = state.experiments.activerecallarena;
      const chip = document.getElementById("chip-activerecallarena");
      if (!chip || !exp) return;
      if (exp.completed) {
        chip.textContent = "Completed";
        chip.classList.add("completed");
      } else if (exp.personalReflection || exp.predictionChoice) {
        chip.textContent = "In progress";
        chip.classList.remove("completed");
      } else {
        chip.textContent = "Not started";
        chip.classList.remove("completed");
      }
    }

    // ---------- EXPERIMENT: ACTIVE RECALL ----------
    const reflectionTextEl = document.getElementById("reflectionText");
    const reflectionMetaEl = document.getElementById("reflectionMeta");
    const reflectionContinueBtn = document.getElementById("reflectionContinueBtn");
    const phase2plusEl = document.getElementById("phase2plus");
    const predictionChoiceEl = document.getElementById("predictionChoice");
    const predictionConfidenceEl = document.getElementById("predictionConfidence");
    const predictionContinueBtn = document.getElementById("predictionContinueBtn");
    const phasePlaceholderEl = document.getElementById("phasePlaceholder");

    function countWords(str) {
      return (str.trim().match(/\S+/g) || []).length;
    }

    function hydrateExperimentUI() {
      const exp = state.experiments.activerecallarena;
      if (!exp) return;

      reflectionTextEl.value = exp.personalReflection || "";
      reflectionMetaEl.textContent = (exp.reflectionWordCount || 0) + " / 100 words";
      if ((exp.reflectionWordCount || 0) >= 100) {
        reflectionContinueBtn.disabled = false;
        phase2plusEl.classList.remove("hidden");
      } else {
        reflectionContinueBtn.disabled = true;
        phase2plusEl.classList.add("hidden");
      }

      predictionChoiceEl.value = exp.predictionChoice || "";
      predictionConfidenceEl.value = exp.predictionConfidence || "";
      if (exp.predictionChoice && exp.predictionConfidence) {
        predictionContinueBtn.disabled = false;
        phasePlaceholderEl.classList.remove("hidden");
      } else {
        predictionContinueBtn.disabled = true;
        phasePlaceholderEl.classList.add("hidden");
      }
    }

    reflectionTextEl.addEventListener("input", () => {
      const text = reflectionTextEl.value;
      const words = countWords(text);
      reflectionMetaEl.textContent = words + " / 100 words";
      const exp = state.experiments.activerecallarena;
      exp.personalReflection = text;
      exp.reflectionWordCount = words;
      reflectionContinueBtn.disabled = words < 100;
      saveState();
    });

    reflectionContinueBtn.addEventListener("click", () => {
      phase2plusEl.classList.remove("hidden");
    });

    function validatePredictionInputs() {
      const choice = predictionChoiceEl.value;
      const conf = predictionConfidenceEl.value;
      const confNum = Number(conf);
      const ok = choice && conf && confNum >= 1 && confNum <= 5;
      predictionContinueBtn.disabled = !ok;
      return ok;
    }

    predictionChoiceEl.addEventListener("change", () => {
      const exp = state.experiments.activerecallarena;
      exp.predictionChoice = predictionChoiceEl.value;
      saveState();
      validatePredictionInputs();
    });

    predictionConfidenceEl.addEventListener("input", () => {
      const exp = state.experiments.activerecallarena;
      exp.predictionConfidence = predictionConfidenceEl.value;
      saveState();
      validatePredictionInputs();
    });

    predictionContinueBtn.addEventListener("click", () => {
      phasePlaceholderEl.classList.remove("hidden");
      // Later, when all phases are complete, you can set exp.completed = true and saveState()
    });

    // ---------- EXPORT & RESET ----------
    document.getElementById("resetBtn").addEventListener("click", () => {
      const ok = confirm("This will clear all saved reflections and progress on this device. Continue?");
      if (!ok) return;
      localStorage.removeItem(STORAGE_KEY);
      state = loadState();
      updateGlobalProgressUI();
      updateExperimentChips();
      hydrateExperimentUI();
      showView("landing");
    });

    document.getElementById("exportBtn").addEventListener("click", () => {
      const exp = state.experiments.activerecallarena;
      let text = "PreMed Learning Science Lab — Reflections Export (UW–Parkside)\n\n";
      text += "Active Recall Arena\n";
      text += "--------------------\n";
      text += "Personal reflection:\n" + (exp.personalReflection || "[none]") + "\n\n";
      text += "Prediction choice: " + (exp.predictionChoice || "[none]") + "\n";
      text += "Prediction confidence (1–5): " + (exp.predictionConfidence || "[none]") + "\n";
      const blob = new Blob([text], { type: "text/plain" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "uwp-premed-study-lab-reflections.txt";
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    });

    // ---------- INIT ----------
    updateGlobalProgressUI();
    updateExperimentChips();
    if (state.lastViewedExperimentId === "activerecallarena") {
      hydrateExperimentUI();
      showView("experiment");
    }
  </script>
</body>
</html>
